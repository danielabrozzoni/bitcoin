# Bitcoin Peer Address Analysis Scripts
## Overview

This directory contains two Python scripts designed to interact with Bitcoin Core:

- getaddr.py: Sends a GETADDR message to Bitcoin peers specified in your Bitcoin Core configuration and extracts the received ADDR messages from the debug logs.
- compare_and_plot.py: Compares the data retrieved by getaddr.py and visualizes overlaps between peer address buckets.

## Prerequisites

- Bitcoin Core: You must compile Bitcoin Core from the current branch. This branch includes modifications to Bitcoin Core's source code to log `GETADDR` responses.
- Python 3.x: Ensure Python 3.x is installed, check requirements in requirements.txt

## First-Time Configuration
### 1. Compile Bitcoin Core

To retrieve GETADDR responses, you must compile Bitcoin Core with this branch code.

### 2. Configure bitcoin.conf

In your bitcoin.conf file, use the connect= directive to specify the nodes you want to connect to. These nodes will be the only ones the script interacts with. For example:

```
connect=node1.example.com
connect=123.45.67.89
```

This ensures the script connects only to the specified peers and retrieves data exclusively from them.

### 3. Update Script Variables

Update the following variables in the scripts as needed:
In `getaddr.py`:
- `BITCOIN_CLI`: Path to the bitcoin-cli executable.
- `PARENT_DIR`: Directory to store output data
- `LOG_PATH`: Path of the Bitcoin Core log file

In `compare.py`:
- DIRECTORY: Path to the folder containing CSV files

## Workflow
### Before Running the Scripts

Prepare Your Environment:
- Compile Bitcoin Core
- Add peer nodes in bitcoin.conf using connect=
- Clean the debug.log file to avoid processing old data
- Start bitcoind and ensure peers specified in the configuration file are connected

Run the Scripts:
- getaddr.py:
  - Sends GETADDR messages to the connected peers
  - Extracts the resulting ADDR messages from debug.log
  - Outputs data into a timestamped folder in the specified directory
- compare_and_plot.py:
  - Processes the CSV files generated by getaddr.py
  - Compares overlaps between peer address buckets
  - Generates a bar chart (`node_address_matches.png`)
